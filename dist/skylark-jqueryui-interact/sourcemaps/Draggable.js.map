{"version":3,"sources":["Draggable.js"],"names":["define","langx","eventer","noder","$","plugins","Mouse","patch","ddmanager","Draggable","inherit","klassName","pluginName","widgetEventPrefix","options","addClasses","appendTo","axis","connectToSortable","containment","cursor","cursorAt","grid","handle","helper","iframeFix","opacity","refreshPositions","revert","revertDuration","scope","scroll","scrollSensitivity","scrollSpeed","snap","snapMode","snapTolerance","stack","zIndex","drag","start","stop","_create","this","_setPositionRelative","_addClass","_setHandleClassName","_mouseInit","_setOption","key","value","_super","_removeHandleClassName","_destroy","element","is","destroyOnClear","_mouseDestroy","_mouseCapture","event","o","disabled","target","closest","length","_getHandle","_blurActiveElement","_blockFrames","selector","iframeBlocks","document","find","map","iframe","css","parent","outerWidth","outerHeight","offset","_unblockFrames","remove","activeElement","active","blur","_mouseStart","_createHelper","_cacheHelperProportions","current","_cacheMargins","cssPosition","scrollParent","offsetParent","hasFixedAncestor","parents","filter","positionAbs","_refreshOffsets","originalPosition","position","_generatePosition","originalPageX","pageX","originalPageY","pageY","_adjustOffsetFromHelper","_setContainment","_trigger","_clear","dropBehaviour","prepareOffsets","_mouseDrag","dragStart","top","margins","left","_getParentOffset","relative","_getRelativeOffset","click","noPropagation","_convertPositionTo","ui","_uiHash","_mouseUp","create","style","_mouseStop","that","dropped","drop","isFunction","call","transit","parseInt","dragStop","handleElement","trigger","overrided","cancel","_removeClass","helperIsFunction","apply","clone","removeAttr","parentNode","test","obj","split","isArray","helperProportions","width","right","height","bottom","_isRootNode","tagName","po","contains","scrollLeft","scrollTop","p","scrollIsRootNode","isUserScrollable","relativeContainer","window","body","scrollHeight","constructor","Array","ce","c","Math","max","scrollWidth","offsetWidth","offsetHeight","d","pos","mod","constrainPosition","co","round","cancelHelperRemoval","destroy","type","patches","register","add","draggable","uiSortable","extend","item","sortables","each","sortable","push","isOver","_storedCSS","placeholder","_helper","innermostIntersecting","_intersectsWith","containerCache","_parent","currentItem","data","fromOutside","_revert","instance","t","_cursor","_opacity","i","scrollParentNotHidden","overflowOffset","scrolled","snapElements","String","items","$t","$o","inst","ts","bs","ls","rs","l","r","b","first","x1","x2","y1","y2","ownerDocument","snapping","release","snapItem","abs","min","group","makeArray","sort","a","_zIndex"],"mappings":"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","file":"../Draggable.js","sourcesContent":["define( [\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-domx-eventer\",\r\n\t\"skylark-domx-noder\",\r\n\t\"skylark-domx-query\",\r\n\t\"skylark-domx-plugins-base\",\r\n\t\"./Mouse\",\r\n\t\"./patch\",\r\n\t\"./ddmanager\",\r\n],function(langx, eventer, noder, $, plugins, Mouse, patch, ddmanager) {\r\n\r\n\tvar Draggable = Mouse.inherit({\r\n\t\tklassName: \"Draggable\",\r\n\r\n\t\tpluginName : \"ui.draggable\",\r\n\r\n\t\twidgetEventPrefix: \"drag\",\r\n\t\toptions: {\r\n\t\t\taddClasses: true,\r\n\t\t\tappendTo: \"parent\",\r\n\t\t\taxis: false,\r\n\t\t\tconnectToSortable: false,\r\n\t\t\tcontainment: false,\r\n\t\t\tcursor: \"auto\",\r\n\t\t\tcursorAt: false,\r\n\t\t\tgrid: false,\r\n\t\t\thandle: false,\r\n\t\t\thelper: \"original\",\r\n\t\t\tiframeFix: false,\r\n\t\t\topacity: false,\r\n\t\t\trefreshPositions: false,\r\n\t\t\trevert: false,\r\n\t\t\trevertDuration: 500,\r\n\t\t\tscope: \"default\",\r\n\t\t\tscroll: true,\r\n\t\t\tscrollSensitivity: 20,\r\n\t\t\tscrollSpeed: 20,\r\n\t\t\tsnap: false,\r\n\t\t\tsnapMode: \"both\",\r\n\t\t\tsnapTolerance: 20,\r\n\t\t\tstack: false,\r\n\t\t\tzIndex: false,\r\n\r\n\t\t\t// Callbacks\r\n\t\t\tdrag: null,\r\n\t\t\tstart: null,\r\n\t\t\tstop: null\r\n\t\t},\r\n\t\t_create: function() {\r\n\r\n\t\t\tif ( this.options.helper === \"original\" ) {\r\n\t\t\t\tthis._setPositionRelative();\r\n\t\t\t}\r\n\t\t\tif ( this.options.addClasses ) {\r\n\t\t\t\tthis._addClass( \"ui-draggable\" );\r\n\t\t\t}\r\n\t\t\tthis._setHandleClassName();\r\n\r\n\t\t\tthis._mouseInit();\r\n\t\t},\r\n\r\n\t\t_setOption: function( key, value ) {\r\n\t\t\tthis._super( key, value );\r\n\t\t\tif ( key === \"handle\" ) {\r\n\t\t\t\tthis._removeHandleClassName();\r\n\t\t\t\tthis._setHandleClassName();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_destroy: function() {\r\n\t\t\tif ( ( this.helper || this.element ).is( \".ui-draggable-dragging\" ) ) {\r\n\t\t\t\tthis.destroyOnClear = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._removeHandleClassName();\r\n\t\t\tthis._mouseDestroy();\r\n\t\t},\r\n\r\n\t\t_mouseCapture: function( event ) {\r\n\t\t\tvar o = this.options;\r\n\r\n\t\t\t// Among others, prevent a drag on a resizable-handle\r\n\t\t\tif ( this.helper || o.disabled ||\r\n\t\t\t\t\t$( event.target ).closest( \".ui-resizable-handle\" ).length > 0 ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t//Quit if we're not on a valid handle\r\n\t\t\tthis.handle = this._getHandle( event );\r\n\t\t\tif ( !this.handle ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tthis._blurActiveElement( event );\r\n\r\n\t\t\tthis._blockFrames( o.iframeFix === true ? \"iframe\" : o.iframeFix );\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\t_blockFrames: function( selector ) {\r\n\t\t\tthis.iframeBlocks = this.document.find( selector ).map( function() {\r\n\t\t\t\tvar iframe = $( this );\r\n\r\n\t\t\t\treturn $( \"<div>\" )\r\n\t\t\t\t\t.css( \"position\", \"absolute\" )\r\n\t\t\t\t\t.appendTo( iframe.parent() )\r\n\t\t\t\t\t.outerWidth( iframe.outerWidth() )\r\n\t\t\t\t\t.outerHeight( iframe.outerHeight() )\r\n\t\t\t\t\t.offset( iframe.offset() )[ 0 ];\r\n\t\t\t} );\r\n\t\t},\r\n\r\n\t\t_unblockFrames: function() {\r\n\t\t\tif ( this.iframeBlocks ) {\r\n\t\t\t\tthis.iframeBlocks.remove();\r\n\t\t\t\tdelete this.iframeBlocks;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_blurActiveElement: function( event ) {\r\n\t\t\tvar activeElement = noder.active( this.document[ 0 ] ),\r\n\t\t\t\ttarget = $( event.target );\r\n\r\n\t\t\t// Don't blur if the event occurred on an element that is within\r\n\t\t\t// the currently focused element\r\n\t\t\t// See #10527, #12472\r\n\t\t\tif ( target.closest( activeElement ).length ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Blur any element that currently has focus, see #4261\r\n\t\t\tnoder.blur( activeElement );\r\n\t\t},\r\n\r\n\t\t_mouseStart: function( event ) {\r\n\r\n\t\t\tvar o = this.options;\r\n\r\n\t\t\t//Create and append the visible helper\r\n\t\t\tthis.helper = this._createHelper( event );\r\n\r\n\t\t\tthis._addClass( this.helper, \"ui-draggable-dragging\" );\r\n\r\n\t\t\t//Cache the helper size\r\n\t\t\tthis._cacheHelperProportions();\r\n\r\n\t\t\t//If ddmanager is used for droppables, set the global draggable\r\n\t\t\tif ( ddmanager ) {\r\n\t\t\t\tddmanager.current = this;\r\n\t\t\t}\r\n\r\n\t\t\t/*\r\n\t\t\t * - Position generation -\r\n\t\t\t * This block generates everything position related - it's the core of draggables.\r\n\t\t\t */\r\n\r\n\t\t\t//Cache the margins of the original element\r\n\t\t\tthis._cacheMargins();\r\n\r\n\t\t\t//Store the helper's css position\r\n\t\t\tthis.cssPosition = this.helper.css( \"position\" );\r\n\t\t\tthis.scrollParent = this.helper.scrollParent( true );\r\n\t\t\tthis.offsetParent = this.helper.offsetParent();\r\n\t\t\tthis.hasFixedAncestor = this.helper.parents().filter( function() {\r\n\t\t\t\t\treturn $( this ).css( \"position\" ) === \"fixed\";\r\n\t\t\t\t} ).length > 0;\r\n\r\n\t\t\t//The element's absolute position on the page minus margins\r\n\t\t\tthis.positionAbs = this.element.offset();\r\n\t\t\tthis._refreshOffsets( event );\r\n\r\n\t\t\t//Generate the original position\r\n\t\t\tthis.originalPosition = this.position = this._generatePosition( event, false );\r\n\t\t\tthis.originalPageX = event.pageX;\r\n\t\t\tthis.originalPageY = event.pageY;\r\n\r\n\t\t\t//Adjust the mouse offset relative to the helper if \"cursorAt\" is supplied\r\n\t\t\t( o.cursorAt && this._adjustOffsetFromHelper( o.cursorAt ) );\r\n\r\n\t\t\t//Set a containment if given in the options\r\n\t\t\tthis._setContainment();\r\n\r\n\t\t\t//Trigger event + callbacks\r\n\t\t\tif ( this._trigger( \"start\", event ) === false ) {\r\n\t\t\t\tthis._clear();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t//Recache the helper size\r\n\t\t\tthis._cacheHelperProportions();\r\n\r\n\t\t\t//Prepare the droppable offsets\r\n\t\t\tif ( ddmanager && !o.dropBehaviour ) {\r\n\t\t\t\tddmanager.prepareOffsets( this, event );\r\n\t\t\t}\r\n\r\n\t\t\t// Execute the drag once - this causes the helper not to be visible before getting its\r\n\t\t\t// correct position\r\n\t\t\tthis._mouseDrag( event, true );\r\n\r\n\t\t\t// If the ddmanager is used for droppables, inform the manager that dragging has started\r\n\t\t\t// (see #5003)\r\n\t\t\tif ( ddmanager ) {\r\n\t\t\t\tddmanager.dragStart( this, event );\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\t_refreshOffsets: function( event ) {\r\n\t\t\tthis.offset = {\r\n\t\t\t\ttop: this.positionAbs.top - this.margins.top,\r\n\t\t\t\tleft: this.positionAbs.left - this.margins.left,\r\n\t\t\t\tscroll: false,\r\n\t\t\t\tparent: this._getParentOffset(),\r\n\t\t\t\trelative: this._getRelativeOffset()\r\n\t\t\t};\r\n\r\n\t\t\tthis.offset.click = {\r\n\t\t\t\tleft: event.pageX - this.offset.left,\r\n\t\t\t\ttop: event.pageY - this.offset.top\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t_mouseDrag: function( event, noPropagation ) {\r\n\r\n\t\t\t// reset any necessary cached properties (see #5009)\r\n\t\t\tif ( this.hasFixedAncestor ) {\r\n\t\t\t\tthis.offset.parent = this._getParentOffset();\r\n\t\t\t}\r\n\r\n\t\t\t//Compute the helpers position\r\n\t\t\tthis.position = this._generatePosition( event, true );\r\n\t\t\tthis.positionAbs = this._convertPositionTo( \"absolute\" );\r\n\r\n\t\t\t//Call patches and callbacks and use the resulting position if something is returned\r\n\t\t\tif ( !noPropagation ) {\r\n\t\t\t\tvar ui = this._uiHash();\r\n\t\t\t\tif ( this._trigger( \"drag\", event, ui ) === false ) {\r\n\t\t\t\t\tthis._mouseUp( new eventer.create( \"mouseup\", event ) );\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.position = ui.position;\r\n\t\t\t}\r\n\r\n\t\t\tthis.helper[ 0 ].style.left = this.position.left + \"px\";\r\n\t\t\tthis.helper[ 0 ].style.top = this.position.top + \"px\";\r\n\r\n\t\t\tif ( ddmanager ) {\r\n\t\t\t\tddmanager.drag( this, event );\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t_mouseStop: function( event ) {\r\n\r\n\t\t\t//If we are using droppables, inform the manager about the drop\r\n\t\t\tvar that = this,\r\n\t\t\t\tdropped = false;\r\n\t\t\tif ( ddmanager && !this.options.dropBehaviour ) {\r\n\t\t\t\tdropped = ddmanager.drop( this, event );\r\n\t\t\t}\r\n\r\n\t\t\t//if a drop comes from outside (a sortable)\r\n\t\t\tif ( this.dropped ) {\r\n\t\t\t\tdropped = this.dropped;\r\n\t\t\t\tthis.dropped = false;\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( this.options.revert === \"invalid\" && !dropped ) ||\r\n\t\t\t\t\t( this.options.revert === \"valid\" && dropped ) ||\r\n\t\t\t\t\tthis.options.revert === true || ( langx.isFunction( this.options.revert ) &&\r\n\t\t\t\t\tthis.options.revert.call( this.element, dropped ) )\r\n\t\t\t) {\r\n\t\t\t\t$( this.helper ).transit(\r\n\t\t\t\t\tthis.originalPosition,\r\n\t\t\t\t\tparseInt( this.options.revertDuration, 10 ),\r\n\t\t\t\t\tfunction() {\r\n\t\t\t\t\t\tif ( that._trigger( \"stop\", event ) !== false ) {\r\n\t\t\t\t\t\t\tthat._clear();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tif ( this._trigger( \"stop\", event ) !== false ) {\r\n\t\t\t\t\tthis._clear();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t_mouseUp: function( event ) {\r\n\t\t\t//TODO : unnecessary?\r\n\t\t\tthis._unblockFrames();\r\n\r\n\t\t\t// If the ddmanager is used for droppables, inform the manager that dragging has stopped\r\n\t\t\t// (see #5003)\r\n\t\t\tif ( ddmanager ) {\r\n\t\t\t\tddmanager.dragStop( this, event );\r\n\t\t\t}\r\n\r\n\t\t\t// Only need to focus if the event occurred on the draggable itself, see #10527\r\n\t\t\tif ( this.handleElement.is( event.target ) ) {\r\n\r\n\t\t\t\t// The interaction is over; whether or not the click resulted in a drag,\r\n\t\t\t\t// focus the element\r\n\t\t\t\tthis.element.trigger( \"focus\" );\r\n\t\t\t}\r\n\r\n\t\t\treturn this.overrided(event );\r\n\t\t},\r\n\r\n\t\tcancel: function() {\r\n\r\n\t\t\tif ( this.helper.is( \".ui-draggable-dragging\" ) ) {\r\n\t\t\t\tthis._mouseUp( eventer.create( \"mouseup\", { target: this.element[ 0 ] }));\r\n\t\t\t} else {\r\n\t\t\t\tthis._clear();\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t_getHandle: function( event ) {\r\n\t\t\treturn this.options.handle ?\r\n\t\t\t\t!!$( event.target ).closest( this.element.find( this.options.handle ) ).length :\r\n\t\t\t\ttrue;\r\n\t\t},\r\n\r\n\t\t_setHandleClassName: function() {\r\n\t\t\tthis.handleElement = this.options.handle ?\r\n\t\t\t\tthis.element.find( this.options.handle ) : this.element;\r\n\t\t\tthis._addClass( this.handleElement, \"ui-draggable-handle\" );\r\n\t\t},\r\n\r\n\t\t_removeHandleClassName: function() {\r\n\t\t\tthis._removeClass( this.handleElement, \"ui-draggable-handle\" );\r\n\t\t},\r\n\r\n\t\t_createHelper: function( event ) {\r\n\r\n\t\t\tvar o = this.options,\r\n\t\t\t\thelperIsFunction = langx.isFunction( o.helper ),\r\n\t\t\t\thelper = helperIsFunction ?\r\n\t\t\t\t\t$( o.helper.apply( this.element[ 0 ], [ event ] ) ) :\r\n\t\t\t\t\t( o.helper === \"clone\" ?\r\n\t\t\t\t\t\tthis.element.clone().removeAttr( \"id\" ) :\r\n\t\t\t\t\t\tthis.element );\r\n\r\n\t\t\tif ( !helper.parents( \"body\" ).length ) {\r\n\t\t\t\thelper.appendTo( ( o.appendTo === \"parent\" ?\r\n\t\t\t\t\tthis.element[ 0 ].parentNode :\r\n\t\t\t\t\to.appendTo ) );\r\n\t\t\t}\r\n\r\n\t\t\t// Http://bugs.jqueryui.com/ticket/9446\r\n\t\t\t// a helper function can return the original element\r\n\t\t\t// which wouldn't have been set to relative in _create\r\n\t\t\tif ( helperIsFunction && helper[ 0 ] === this.element[ 0 ] ) {\r\n\t\t\t\tthis._setPositionRelative();\r\n\t\t\t}\r\n\r\n\t\t\tif ( helper[ 0 ] !== this.element[ 0 ] &&\r\n\t\t\t\t\t!( /(fixed|absolute)/ ).test( helper.css( \"position\" ) ) ) {\r\n\t\t\t\thelper.css( \"position\", \"absolute\" );\r\n\t\t\t}\r\n\r\n\t\t\treturn helper;\r\n\r\n\t\t},\r\n\r\n\t\t_setPositionRelative: function() {\r\n\t\t\tif ( !( /^(?:r|a|f)/ ).test( this.element.css( \"position\" ) ) ) {\r\n\t\t\t\tthis.element[ 0 ].style.position = \"relative\";\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_adjustOffsetFromHelper: function( obj ) {\r\n\t\t\tif ( typeof obj === \"string\" ) {\r\n\t\t\t\tobj = obj.split( \" \" );\r\n\t\t\t}\r\n\t\t\tif ( langx.isArray( obj ) ) {\r\n\t\t\t\tobj = { left: +obj[ 0 ], top: +obj[ 1 ] || 0 };\r\n\t\t\t}\r\n\t\t\tif ( \"left\" in obj ) {\r\n\t\t\t\tthis.offset.click.left = obj.left + this.margins.left;\r\n\t\t\t}\r\n\t\t\tif ( \"right\" in obj ) {\r\n\t\t\t\tthis.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;\r\n\t\t\t}\r\n\t\t\tif ( \"top\" in obj ) {\r\n\t\t\t\tthis.offset.click.top = obj.top + this.margins.top;\r\n\t\t\t}\r\n\t\t\tif ( \"bottom\" in obj ) {\r\n\t\t\t\tthis.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_isRootNode: function( element ) {\r\n\t\t\treturn ( /(html|body)/i ).test( element.tagName ) || element === this.document[ 0 ];\r\n\t\t},\r\n\r\n\t\t_getParentOffset: function() {\r\n\r\n\t\t\t//Get the offsetParent and cache its position\r\n\t\t\tvar po = this.offsetParent.offset(),\r\n\t\t\t\tdocument = this.document[ 0 ];\r\n\r\n\t\t\t// This is a special case where we need to modify a offset calculated on start, since the\r\n\t\t\t// following happened:\r\n\t\t\t// 1. The position of the helper is absolute, so it's position is calculated based on the\r\n\t\t\t// next positioned parent\r\n\t\t\t// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't\r\n\t\t\t// the document, which means that the scroll is included in the initial calculation of the\r\n\t\t\t// offset of the parent, and never recalculated upon drag\r\n\t\t\tif ( this.cssPosition === \"absolute\" && this.scrollParent[ 0 ] !== document &&\r\n\t\t\t\t\tnoder.contains( this.scrollParent[ 0 ], this.offsetParent[ 0 ] ) ) {\r\n\t\t\t\tpo.left += this.scrollParent.scrollLeft();\r\n\t\t\t\tpo.top += this.scrollParent.scrollTop();\r\n\t\t\t}\r\n\r\n\t\t\tif ( this._isRootNode( this.offsetParent[ 0 ] ) ) {\r\n\t\t\t\tpo = { top: 0, left: 0 };\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\ttop: po.top + ( parseInt( this.offsetParent.css( \"borderTopWidth\" ), 10 ) || 0 ),\r\n\t\t\t\tleft: po.left + ( parseInt( this.offsetParent.css( \"borderLeftWidth\" ), 10 ) || 0 )\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\t_getRelativeOffset: function() {\r\n\t\t\tif ( this.cssPosition !== \"relative\" ) {\r\n\t\t\t\treturn { top: 0, left: 0 };\r\n\t\t\t}\r\n\r\n\t\t\tvar p = this.element.position(),\r\n\t\t\t\tscrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );\r\n\r\n\t\t\treturn {\r\n\t\t\t\ttop: p.top - ( parseInt( this.helper.css( \"top\" ), 10 ) || 0 ) +\r\n\t\t\t\t\t( !scrollIsRootNode ? this.scrollParent.scrollTop() : 0 ),\r\n\t\t\t\tleft: p.left - ( parseInt( this.helper.css( \"left\" ), 10 ) || 0 ) +\r\n\t\t\t\t\t( !scrollIsRootNode ? this.scrollParent.scrollLeft() : 0 )\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\t_cacheMargins: function() {\r\n\t\t\tthis.margins = {\r\n\t\t\t\tleft: ( parseInt( this.element.css( \"marginLeft\" ), 10 ) || 0 ),\r\n\t\t\t\ttop: ( parseInt( this.element.css( \"marginTop\" ), 10 ) || 0 ),\r\n\t\t\t\tright: ( parseInt( this.element.css( \"marginRight\" ), 10 ) || 0 ),\r\n\t\t\t\tbottom: ( parseInt( this.element.css( \"marginBottom\" ), 10 ) || 0 )\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t_cacheHelperProportions: function() {\r\n\t\t\tthis.helperProportions = {\r\n\t\t\t\twidth: this.helper.outerWidth(),\r\n\t\t\t\theight: this.helper.outerHeight()\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t_setContainment: function() {\r\n\r\n\t\t\tvar isUserScrollable, c, ce,\r\n\t\t\t\to = this.options,\r\n\t\t\t\tdocument = this.document[ 0 ];\r\n\r\n\t\t\tthis.relativeContainer = null;\r\n\r\n\t\t\tif ( !o.containment ) {\r\n\t\t\t\tthis.containment = null;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( o.containment === \"window\" ) {\r\n\t\t\t\tthis.containment = [\r\n\t\t\t\t\t$( window ).scrollLeft() - this.offset.relative.left - this.offset.parent.left,\r\n\t\t\t\t\t$( window ).scrollTop() - this.offset.relative.top - this.offset.parent.top,\r\n\t\t\t\t\t$( window ).scrollLeft() + $( window ).width() -\r\n\t\t\t\t\t\tthis.helperProportions.width - this.margins.left,\r\n\t\t\t\t\t$( window ).scrollTop() +\r\n\t\t\t\t\t\t( $( window ).height() || document.body.parentNode.scrollHeight ) -\r\n\t\t\t\t\t\tthis.helperProportions.height - this.margins.top\r\n\t\t\t\t];\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( o.containment === \"document\" ) {\r\n\t\t\t\tthis.containment = [\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t0,\r\n\t\t\t\t\t$( document ).width() - this.helperProportions.width - this.margins.left,\r\n\t\t\t\t\t( $( document ).height() || document.body.parentNode.scrollHeight ) -\r\n\t\t\t\t\t\tthis.helperProportions.height - this.margins.top\r\n\t\t\t\t];\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( o.containment.constructor === Array ) {\r\n\t\t\t\tthis.containment = o.containment;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( o.containment === \"parent\" ) {\r\n\t\t\t\to.containment = this.helper[ 0 ].parentNode;\r\n\t\t\t}\r\n\r\n\t\t\tc = $( o.containment );\r\n\t\t\tce = c[ 0 ];\r\n\r\n\t\t\tif ( !ce ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tisUserScrollable = /(scroll|auto)/.test( c.css( \"overflow\" ) );\r\n\r\n\t\t\tthis.containment = [\r\n\t\t\t\t( parseInt( c.css( \"borderLeftWidth\" ), 10 ) || 0 ) +\r\n\t\t\t\t\t( parseInt( c.css( \"paddingLeft\" ), 10 ) || 0 ),\r\n\t\t\t\t( parseInt( c.css( \"borderTopWidth\" ), 10 ) || 0 ) +\r\n\t\t\t\t\t( parseInt( c.css( \"paddingTop\" ), 10 ) || 0 ),\r\n\t\t\t\t( isUserScrollable ? Math.max( ce.scrollWidth, ce.offsetWidth ) : ce.offsetWidth ) -\r\n\t\t\t\t\t( parseInt( c.css( \"borderRightWidth\" ), 10 ) || 0 ) -\r\n\t\t\t\t\t( parseInt( c.css( \"paddingRight\" ), 10 ) || 0 ) -\r\n\t\t\t\t\tthis.helperProportions.width -\r\n\t\t\t\t\tthis.margins.left -\r\n\t\t\t\t\tthis.margins.right,\r\n\t\t\t\t( isUserScrollable ? Math.max( ce.scrollHeight, ce.offsetHeight ) : ce.offsetHeight ) -\r\n\t\t\t\t\t( parseInt( c.css( \"borderBottomWidth\" ), 10 ) || 0 ) -\r\n\t\t\t\t\t( parseInt( c.css( \"paddingBottom\" ), 10 ) || 0 ) -\r\n\t\t\t\t\tthis.helperProportions.height -\r\n\t\t\t\t\tthis.margins.top -\r\n\t\t\t\t\tthis.margins.bottom\r\n\t\t\t];\r\n\t\t\tthis.relativeContainer = c;\r\n\t\t},\r\n\r\n\t\t_convertPositionTo: function( d, pos ) {\r\n\r\n\t\t\tif ( !pos ) {\r\n\t\t\t\tpos = this.position;\r\n\t\t\t}\r\n\r\n\t\t\tvar mod = d === \"absolute\" ? 1 : -1,\r\n\t\t\t\tscrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );\r\n\r\n\t\t\treturn {\r\n\t\t\t\ttop: (\r\n\r\n\t\t\t\t\t// The absolute mouse position\r\n\t\t\t\t\tpos.top\t+\r\n\r\n\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\r\n\t\t\t\t\tthis.offset.relative.top * mod +\r\n\r\n\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\r\n\t\t\t\t\tthis.offset.parent.top * mod -\r\n\t\t\t\t\t( ( this.cssPosition === \"fixed\" ?\r\n\t\t\t\t\t\t-this.offset.scroll.top :\r\n\t\t\t\t\t\t( scrollIsRootNode ? 0 : this.offset.scroll.top ) ) * mod )\r\n\t\t\t\t),\r\n\t\t\t\tleft: (\r\n\r\n\t\t\t\t\t// The absolute mouse position\r\n\t\t\t\t\tpos.left +\r\n\r\n\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\r\n\t\t\t\t\tthis.offset.relative.left * mod +\r\n\r\n\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\r\n\t\t\t\t\tthis.offset.parent.left * mod\t-\r\n\t\t\t\t\t( ( this.cssPosition === \"fixed\" ?\r\n\t\t\t\t\t\t-this.offset.scroll.left :\r\n\t\t\t\t\t\t( scrollIsRootNode ? 0 : this.offset.scroll.left ) ) * mod )\r\n\t\t\t\t)\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\t_generatePosition: function( event, constrainPosition ) {\r\n\r\n\t\t\tvar containment, co, top, left,\r\n\t\t\t\to = this.options,\r\n\t\t\t\tscrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] ),\r\n\t\t\t\tpageX = event.pageX,\r\n\t\t\t\tpageY = event.pageY;\r\n\r\n\t\t\t// Cache the scroll\r\n\t\t\tif ( !scrollIsRootNode || !this.offset.scroll ) {\r\n\t\t\t\tthis.offset.scroll = {\r\n\t\t\t\t\ttop: this.scrollParent.scrollTop(),\r\n\t\t\t\t\tleft: this.scrollParent.scrollLeft()\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\t/*\r\n\t\t\t * - Position constraining -\r\n\t\t\t * Constrain the position to a mix of grid, containment.\r\n\t\t\t */\r\n\r\n\t\t\t// If we are not dragging yet, we won't check for options\r\n\t\t\tif ( constrainPosition ) {\r\n\t\t\t\tif ( this.containment ) {\r\n\t\t\t\t\tif ( this.relativeContainer ) {\r\n\t\t\t\t\t\tco = this.relativeContainer.offset();\r\n\t\t\t\t\t\tcontainment = [\r\n\t\t\t\t\t\t\tthis.containment[ 0 ] + co.left,\r\n\t\t\t\t\t\t\tthis.containment[ 1 ] + co.top,\r\n\t\t\t\t\t\t\tthis.containment[ 2 ] + co.left,\r\n\t\t\t\t\t\t\tthis.containment[ 3 ] + co.top\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcontainment = this.containment;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( event.pageX - this.offset.click.left < containment[ 0 ] ) {\r\n\t\t\t\t\t\tpageX = containment[ 0 ] + this.offset.click.left;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( event.pageY - this.offset.click.top < containment[ 1 ] ) {\r\n\t\t\t\t\t\tpageY = containment[ 1 ] + this.offset.click.top;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( event.pageX - this.offset.click.left > containment[ 2 ] ) {\r\n\t\t\t\t\t\tpageX = containment[ 2 ] + this.offset.click.left;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( event.pageY - this.offset.click.top > containment[ 3 ] ) {\r\n\t\t\t\t\t\tpageY = containment[ 3 ] + this.offset.click.top;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( o.grid ) {\r\n\r\n\t\t\t\t\t//Check for grid elements set to 0 to prevent divide by 0 error causing invalid\r\n\t\t\t\t\t// argument errors in IE (see ticket #6950)\r\n\t\t\t\t\ttop = o.grid[ 1 ] ? this.originalPageY + Math.round( ( pageY -\r\n\t\t\t\t\t\tthis.originalPageY ) / o.grid[ 1 ] ) * o.grid[ 1 ] : this.originalPageY;\r\n\t\t\t\t\tpageY = containment ? ( ( top - this.offset.click.top >= containment[ 1 ] ||\r\n\t\t\t\t\t\ttop - this.offset.click.top > containment[ 3 ] ) ?\r\n\t\t\t\t\t\t\ttop :\r\n\t\t\t\t\t\t\t( ( top - this.offset.click.top >= containment[ 1 ] ) ?\r\n\t\t\t\t\t\t\t\ttop - o.grid[ 1 ] : top + o.grid[ 1 ] ) ) : top;\r\n\r\n\t\t\t\t\tleft = o.grid[ 0 ] ? this.originalPageX +\r\n\t\t\t\t\t\tMath.round( ( pageX - this.originalPageX ) / o.grid[ 0 ] ) * o.grid[ 0 ] :\r\n\t\t\t\t\t\tthis.originalPageX;\r\n\t\t\t\t\tpageX = containment ? ( ( left - this.offset.click.left >= containment[ 0 ] ||\r\n\t\t\t\t\t\tleft - this.offset.click.left > containment[ 2 ] ) ?\r\n\t\t\t\t\t\t\tleft :\r\n\t\t\t\t\t\t\t( ( left - this.offset.click.left >= containment[ 0 ] ) ?\r\n\t\t\t\t\t\t\t\tleft - o.grid[ 0 ] : left + o.grid[ 0 ] ) ) : left;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( o.axis === \"y\" ) {\r\n\t\t\t\t\tpageX = this.originalPageX;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( o.axis === \"x\" ) {\r\n\t\t\t\t\tpageY = this.originalPageY;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\ttop: (\r\n\r\n\t\t\t\t\t// The absolute mouse position\r\n\t\t\t\t\tpageY -\r\n\r\n\t\t\t\t\t// Click offset (relative to the element)\r\n\t\t\t\t\tthis.offset.click.top -\r\n\r\n\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\r\n\t\t\t\t\tthis.offset.relative.top -\r\n\r\n\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\r\n\t\t\t\t\tthis.offset.parent.top +\r\n\t\t\t\t\t( this.cssPosition === \"fixed\" ?\r\n\t\t\t\t\t\t-this.offset.scroll.top :\r\n\t\t\t\t\t\t( scrollIsRootNode ? 0 : this.offset.scroll.top ) )\r\n\t\t\t\t),\r\n\t\t\t\tleft: (\r\n\r\n\t\t\t\t\t// The absolute mouse position\r\n\t\t\t\t\tpageX -\r\n\r\n\t\t\t\t\t// Click offset (relative to the element)\r\n\t\t\t\t\tthis.offset.click.left -\r\n\r\n\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\r\n\t\t\t\t\tthis.offset.relative.left -\r\n\r\n\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\r\n\t\t\t\t\tthis.offset.parent.left +\r\n\t\t\t\t\t( this.cssPosition === \"fixed\" ?\r\n\t\t\t\t\t\t-this.offset.scroll.left :\r\n\t\t\t\t\t\t( scrollIsRootNode ? 0 : this.offset.scroll.left ) )\r\n\t\t\t\t)\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\t_clear: function() {\r\n\t\t\tthis._removeClass( this.helper, \"ui-draggable-dragging\" );\r\n\t\t\tif ( this.helper[ 0 ] !== this.element[ 0 ] && !this.cancelHelperRemoval ) {\r\n\t\t\t\tthis.helper.remove();\r\n\t\t\t}\r\n\t\t\tthis.helper = null;\r\n\t\t\tthis.cancelHelperRemoval = false;\r\n\t\t\tif ( this.destroyOnClear ) {\r\n\t\t\t\tthis.destroy();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// From now on bulk stuff - mainly helpers\r\n\r\n\t\t_trigger: function( type, event, ui ) {\r\n\t\t\tui = ui || this._uiHash();\r\n\t\t\tpatch.call( this, type, [ event, ui, this ], true );\r\n\r\n\t\t\t// Absolute position and offset (see #6884 ) have to be recalculated after patches\r\n\t\t\tif ( /^(drag|start|stop)/.test( type ) ) {\r\n\t\t\t\tthis.positionAbs = this._convertPositionTo( \"absolute\" );\r\n\t\t\t\tui.offset = this.positionAbs;\r\n\t\t\t}\r\n\t\t\treturn this.overrided( type, event, ui );\r\n\t\t},\r\n\r\n\t\tpatches: {},\r\n\r\n\t\t_uiHash: function() {\r\n\t\t\treturn {\r\n\t\t\t\thelper: this.helper,\r\n\t\t\t\tposition: this.position,\r\n\t\t\t\toriginalPosition: this.originalPosition,\r\n\t\t\t\toffset: this.positionAbs\r\n\t\t\t};\r\n\t\t}\r\n\r\n\r\n\r\n\t});\r\n\r\n\r\n\tplugins.register(Draggable,\"draggable\");\r\n\r\n\tpatch.add(Draggable, \"connectToSortable\", {\r\n\t\tstart: function( event, ui, draggable ) {\r\n\t\t\tvar uiSortable = langx.extend( {}, ui, {\r\n\t\t\t\titem: draggable.element\r\n\t\t\t} );\r\n\r\n\t\t\tdraggable.sortables = [];\r\n\t\t\t$( draggable.options.connectToSortable ).each( function() {\r\n\t\t\t\tvar sortable = $( this ).sortable( \"instance\" );\r\n\r\n\t\t\t\tif ( sortable && !sortable.options.disabled ) {\r\n\t\t\t\t\tdraggable.sortables.push( sortable );\r\n\r\n\t\t\t\t\t// RefreshPositions is called at drag start to refresh the containerCache\r\n\t\t\t\t\t// which is used in drag. This ensures it's initialized and synchronized\r\n\t\t\t\t\t// with any changes that might have happened on the page since initialization.\r\n\t\t\t\t\tsortable.refreshPositions();\r\n\t\t\t\t\tsortable._trigger( \"activate\", event, uiSortable );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\t\tstop: function( event, ui, draggable ) {\r\n\t\t\tvar uiSortable = langx.extend( {}, ui, {\r\n\t\t\t\titem: draggable.element\r\n\t\t\t} );\r\n\r\n\t\t\tdraggable.cancelHelperRemoval = false;\r\n\r\n\t\t\tlangx.each( draggable.sortables, function() {\r\n\t\t\t\tvar sortable = this;\r\n\r\n\t\t\t\tif ( sortable.isOver ) {\r\n\t\t\t\t\tsortable.isOver = 0;\r\n\r\n\t\t\t\t\t// Allow this sortable to handle removing the helper\r\n\t\t\t\t\tdraggable.cancelHelperRemoval = true;\r\n\t\t\t\t\tsortable.cancelHelperRemoval = false;\r\n\r\n\t\t\t\t\t// Use _storedCSS To restore properties in the sortable,\r\n\t\t\t\t\t// as this also handles revert (#9675) since the draggable\r\n\t\t\t\t\t// may have modified them in unexpected ways (#8809)\r\n\t\t\t\t\tsortable._storedCSS = {\r\n\t\t\t\t\t\tposition: sortable.placeholder.css( \"position\" ),\r\n\t\t\t\t\t\ttop: sortable.placeholder.css( \"top\" ),\r\n\t\t\t\t\t\tleft: sortable.placeholder.css( \"left\" )\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tsortable._mouseStop( event );\r\n\r\n\t\t\t\t\t// Once drag has ended, the sortable should return to using\r\n\t\t\t\t\t// its original helper, not the shared helper from draggable\r\n\t\t\t\t\tsortable.options.helper = sortable.options._helper;\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// Prevent this Sortable from removing the helper.\r\n\t\t\t\t\t// However, don't set the draggable to remove the helper\r\n\t\t\t\t\t// either as another connected Sortable may yet handle the removal.\r\n\t\t\t\t\tsortable.cancelHelperRemoval = true;\r\n\r\n\t\t\t\t\tsortable._trigger( \"deactivate\", event, uiSortable );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\t\tdrag: function( event, ui, draggable ) {\r\n\t\t\tlangx.each( draggable.sortables, function() {\r\n\t\t\t\tvar innermostIntersecting = false,\r\n\t\t\t\t\tsortable = this;\r\n\r\n\t\t\t\t// Copy over variables that sortable's _intersectsWith uses\r\n\t\t\t\tsortable.positionAbs = draggable.positionAbs;\r\n\t\t\t\tsortable.helperProportions = draggable.helperProportions;\r\n\t\t\t\tsortable.offset.click = draggable.offset.click;\r\n\r\n\t\t\t\tif ( sortable._intersectsWith( sortable.containerCache ) ) {\r\n\t\t\t\t\tinnermostIntersecting = true;\r\n\r\n\t\t\t\t\tlangx.each( draggable.sortables, function() {\r\n\r\n\t\t\t\t\t\t// Copy over variables that sortable's _intersectsWith uses\r\n\t\t\t\t\t\tthis.positionAbs = draggable.positionAbs;\r\n\t\t\t\t\t\tthis.helperProportions = draggable.helperProportions;\r\n\t\t\t\t\t\tthis.offset.click = draggable.offset.click;\r\n\r\n\t\t\t\t\t\tif ( this !== sortable &&\r\n\t\t\t\t\t\t\t\tthis._intersectsWith( this.containerCache ) &&\r\n\t\t\t\t\t\t\t\tnoder.contains( sortable.element[ 0 ], this.element[ 0 ] ) ) {\r\n\t\t\t\t\t\t\tinnermostIntersecting = false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn innermostIntersecting;\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( innermostIntersecting ) {\r\n\r\n\t\t\t\t\t// If it intersects, we use a little isOver variable and set it once,\r\n\t\t\t\t\t// so that the move-in stuff gets fired only once.\r\n\t\t\t\t\tif ( !sortable.isOver ) {\r\n\t\t\t\t\t\tsortable.isOver = 1;\r\n\r\n\t\t\t\t\t\t// Store draggable's parent in case we need to reappend to it later.\r\n\t\t\t\t\t\tdraggable._parent = ui.helper.parent();\r\n\r\n\t\t\t\t\t\tsortable.currentItem = ui.helper\r\n\t\t\t\t\t\t\t.appendTo( sortable.element )\r\n\t\t\t\t\t\t\t.data( \"ui-sortable-item\", true );\r\n\r\n\t\t\t\t\t\t// Store helper option to later restore it\r\n\t\t\t\t\t\tsortable.options._helper = sortable.options.helper;\r\n\r\n\t\t\t\t\t\tsortable.options.helper = function() {\r\n\t\t\t\t\t\t\treturn ui.helper[ 0 ];\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t// Fire the start events of the sortable with our passed browser event,\r\n\t\t\t\t\t\t// and our own helper (so it doesn't create a new one)\r\n\t\t\t\t\t\tevent.target = sortable.currentItem[ 0 ];\r\n\t\t\t\t\t\tsortable._mouseCapture( event, true );\r\n\t\t\t\t\t\tsortable._mouseStart( event, true, true );\r\n\r\n\t\t\t\t\t\t// Because the browser event is way off the new appended portlet,\r\n\t\t\t\t\t\t// modify necessary variables to reflect the changes\r\n\t\t\t\t\t\tsortable.offset.click.top = draggable.offset.click.top;\r\n\t\t\t\t\t\tsortable.offset.click.left = draggable.offset.click.left;\r\n\t\t\t\t\t\tsortable.offset.parent.left -= draggable.offset.parent.left -\r\n\t\t\t\t\t\t\tsortable.offset.parent.left;\r\n\t\t\t\t\t\tsortable.offset.parent.top -= draggable.offset.parent.top -\r\n\t\t\t\t\t\t\tsortable.offset.parent.top;\r\n\r\n\t\t\t\t\t\tdraggable._trigger( \"toSortable\", event );\r\n\r\n\t\t\t\t\t\t// Inform draggable that the helper is in a valid drop zone,\r\n\t\t\t\t\t\t// used solely in the revert option to handle \"valid/invalid\".\r\n\t\t\t\t\t\tdraggable.dropped = sortable.element;\r\n\r\n\t\t\t\t\t\t// Need to refreshPositions of all sortables in the case that\r\n\t\t\t\t\t\t// adding to one sortable changes the location of the other sortables (#9675)\r\n\t\t\t\t\t\tlangx.each( draggable.sortables, function() {\r\n\t\t\t\t\t\t\tthis.refreshPositions();\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t// Hack so receive/update callbacks work (mostly)\r\n\t\t\t\t\t\tdraggable.currentItem = draggable.element;\r\n\t\t\t\t\t\tsortable.fromOutside = draggable;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( sortable.currentItem ) {\r\n\t\t\t\t\t\tsortable._mouseDrag( event );\r\n\r\n\t\t\t\t\t\t// Copy the sortable's position because the draggable's can potentially reflect\r\n\t\t\t\t\t\t// a relative position, while sortable is always absolute, which the dragged\r\n\t\t\t\t\t\t// element has now become. (#8809)\r\n\t\t\t\t\t\tui.position = sortable.position;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// If it doesn't intersect with the sortable, and it intersected before,\r\n\t\t\t\t\t// we fake the drag stop of the sortable, but make sure it doesn't remove\r\n\t\t\t\t\t// the helper by using cancelHelperRemoval.\r\n\t\t\t\t\tif ( sortable.isOver ) {\r\n\r\n\t\t\t\t\t\tsortable.isOver = 0;\r\n\t\t\t\t\t\tsortable.cancelHelperRemoval = true;\r\n\r\n\t\t\t\t\t\t// Calling sortable's mouseStop would trigger a revert,\r\n\t\t\t\t\t\t// so revert must be temporarily false until after mouseStop is called.\r\n\t\t\t\t\t\tsortable.options._revert = sortable.options.revert;\r\n\t\t\t\t\t\tsortable.options.revert = false;\r\n\r\n\t\t\t\t\t\tsortable._trigger( \"out\", event, sortable._uiHash( sortable ) );\r\n\t\t\t\t\t\tsortable._mouseStop( event, true );\r\n\r\n\t\t\t\t\t\t// Restore sortable behaviors that were modfied\r\n\t\t\t\t\t\t// when the draggable entered the sortable area (#9481)\r\n\t\t\t\t\t\tsortable.options.revert = sortable.options._revert;\r\n\t\t\t\t\t\tsortable.options.helper = sortable.options._helper;\r\n\r\n\t\t\t\t\t\tif ( sortable.placeholder ) {\r\n\t\t\t\t\t\t\tsortable.placeholder.remove();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Restore and recalculate the draggable's offset considering the sortable\r\n\t\t\t\t\t\t// may have modified them in unexpected ways. (#8809, #10669)\r\n\t\t\t\t\t\tui.helper.appendTo( draggable._parent );\r\n\t\t\t\t\t\tdraggable._refreshOffsets( event );\r\n\t\t\t\t\t\tui.position = draggable._generatePosition( event, true );\r\n\r\n\t\t\t\t\t\tdraggable._trigger( \"fromSortable\", event );\r\n\r\n\t\t\t\t\t\t// Inform draggable that the helper is no longer in a valid drop zone\r\n\t\t\t\t\t\tdraggable.dropped = false;\r\n\r\n\t\t\t\t\t\t// Need to refreshPositions of all sortables just in case removing\r\n\t\t\t\t\t\t// from one sortable changes the location of other sortables (#9675)\r\n\t\t\t\t\t\tlangx.each( draggable.sortables, function() {\r\n\t\t\t\t\t\t\tthis.refreshPositions();\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\t});\r\n\r\n\tpatch.add( Draggable, \"cursor\", {\r\n\t\tstart: function( event, ui, instance ) {\r\n\t\t\tvar t = $( \"body\" ),\r\n\t\t\t\to = instance.options;\r\n\r\n\t\t\tif ( t.css( \"cursor\" ) ) {\r\n\t\t\t\to._cursor = t.css( \"cursor\" );\r\n\t\t\t}\r\n\t\t\tt.css( \"cursor\", o.cursor );\r\n\t\t},\r\n\t\tstop: function( event, ui, instance ) {\r\n\t\t\tvar o = instance.options;\r\n\t\t\tif ( o._cursor ) {\r\n\t\t\t\t$( \"body\" ).css( \"cursor\", o._cursor );\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n\r\n\tpatch.add( Draggable, \"opacity\", {\r\n\t\tstart: function( event, ui, instance ) {\r\n\t\t\tvar t = $( ui.helper ),\r\n\t\t\t\to = instance.options;\r\n\t\t\tif ( t.css( \"opacity\" ) ) {\r\n\t\t\t\to._opacity = t.css( \"opacity\" );\r\n\t\t\t}\r\n\t\t\tt.css( \"opacity\", o.opacity );\r\n\t\t},\r\n\t\tstop: function( event, ui, instance ) {\r\n\t\t\tvar o = instance.options;\r\n\t\t\tif ( o._opacity ) {\r\n\t\t\t\t$( ui.helper ).css( \"opacity\", o._opacity );\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n\r\n\tpatch.add( Draggable, \"scroll\", {\r\n\t\tstart: function( event, ui, i ) {\r\n\t\t\tif ( !i.scrollParentNotHidden ) {\r\n\t\t\t\ti.scrollParentNotHidden = i.helper.scrollParent( false );\r\n\t\t\t}\r\n\r\n\t\t\tif ( i.scrollParentNotHidden[ 0 ] !== i.document[ 0 ] &&\r\n\t\t\t\t\ti.scrollParentNotHidden[ 0 ].tagName !== \"HTML\" ) {\r\n\t\t\t\ti.overflowOffset = i.scrollParentNotHidden.offset();\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrag: function( event, ui, i  ) {\r\n\r\n\t\t\tvar o = i.options,\r\n\t\t\t\tscrolled = false,\r\n\t\t\t\tscrollParent = i.scrollParentNotHidden[ 0 ],\r\n\t\t\t\tdocument = i.document[ 0 ];\r\n\r\n\t\t\tif ( scrollParent !== document && scrollParent.tagName !== \"HTML\" ) {\r\n\t\t\t\tif ( !o.axis || o.axis !== \"x\" ) {\r\n\t\t\t\t\tif ( ( i.overflowOffset.top + scrollParent.offsetHeight ) - event.pageY <\r\n\t\t\t\t\t\t\to.scrollSensitivity ) {\r\n\t\t\t\t\t\tscrollParent.scrollTop = scrolled = scrollParent.scrollTop + o.scrollSpeed;\r\n\t\t\t\t\t} else if ( event.pageY - i.overflowOffset.top < o.scrollSensitivity ) {\r\n\t\t\t\t\t\tscrollParent.scrollTop = scrolled = scrollParent.scrollTop - o.scrollSpeed;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( !o.axis || o.axis !== \"y\" ) {\r\n\t\t\t\t\tif ( ( i.overflowOffset.left + scrollParent.offsetWidth ) - event.pageX <\r\n\t\t\t\t\t\t\to.scrollSensitivity ) {\r\n\t\t\t\t\t\tscrollParent.scrollLeft = scrolled = scrollParent.scrollLeft + o.scrollSpeed;\r\n\t\t\t\t\t} else if ( event.pageX - i.overflowOffset.left < o.scrollSensitivity ) {\r\n\t\t\t\t\t\tscrollParent.scrollLeft = scrolled = scrollParent.scrollLeft - o.scrollSpeed;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( !o.axis || o.axis !== \"x\" ) {\r\n\t\t\t\t\tif ( event.pageY - $( document ).scrollTop() < o.scrollSensitivity ) {\r\n\t\t\t\t\t\tscrolled = $( document ).scrollTop( $( document ).scrollTop() - o.scrollSpeed );\r\n\t\t\t\t\t} else if ( $( window ).height() - ( event.pageY - $( document ).scrollTop() ) <\r\n\t\t\t\t\t\t\to.scrollSensitivity ) {\r\n\t\t\t\t\t\tscrolled = $( document ).scrollTop( $( document ).scrollTop() + o.scrollSpeed );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( !o.axis || o.axis !== \"y\" ) {\r\n\t\t\t\t\tif ( event.pageX - $( document ).scrollLeft() < o.scrollSensitivity ) {\r\n\t\t\t\t\t\tscrolled = $( document ).scrollLeft(\r\n\t\t\t\t\t\t\t$( document ).scrollLeft() - o.scrollSpeed\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else if ( $( window ).width() - ( event.pageX - $( document ).scrollLeft() ) <\r\n\t\t\t\t\t\t\to.scrollSensitivity ) {\r\n\t\t\t\t\t\tscrolled = $( document ).scrollLeft(\r\n\t\t\t\t\t\t\t$( document ).scrollLeft() + o.scrollSpeed\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( scrolled !== false && ddmanager && !o.dropBehaviour ) {\r\n\t\t\t\tddmanager.prepareOffsets( i, event );\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t} );\r\n\r\n\tpatch.add( Draggable, \"snap\", {\r\n\t\tstart: function( event, ui, i ) {\r\n\r\n\t\t\tvar o = i.options;\r\n\r\n\t\t\ti.snapElements = [];\r\n\r\n\t\t\t$( o.snap.constructor !== String ? ( o.snap.items || \":data(ui-draggable)\" ) : o.snap )\r\n\t\t\t\t.each( function() {\r\n\t\t\t\t\tvar $t = $( this ),\r\n\t\t\t\t\t\t$o = $t.offset();\r\n\t\t\t\t\tif ( this !== i.element[ 0 ] ) {\r\n\t\t\t\t\t\ti.snapElements.push( {\r\n\t\t\t\t\t\t\titem: this,\r\n\t\t\t\t\t\t\twidth: $t.outerWidth(), height: $t.outerHeight(),\r\n\t\t\t\t\t\t\ttop: $o.top, left: $o.left\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\r\n\t\t},\r\n\t\tdrag: function( event, ui, inst ) {\r\n\r\n\t\t\tvar ts, bs, ls, rs, l, r, t, b, i, first,\r\n\t\t\t\to = inst.options,\r\n\t\t\t\td = o.snapTolerance,\r\n\t\t\t\tx1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,\r\n\t\t\t\ty1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;\r\n\r\n\t\t\tfor ( i = inst.snapElements.length - 1; i >= 0; i-- ) {\r\n\r\n\t\t\t\tl = inst.snapElements[ i ].left - inst.margins.left;\r\n\t\t\t\tr = l + inst.snapElements[ i ].width;\r\n\t\t\t\tt = inst.snapElements[ i ].top - inst.margins.top;\r\n\t\t\t\tb = t + inst.snapElements[ i ].height;\r\n\r\n\t\t\t\tif ( x2 < l - d || x1 > r + d || y2 < t - d || y1 > b + d ||\r\n\t\t\t\t\t\t!noder.contains( inst.snapElements[ i ].item.ownerDocument,\r\n\t\t\t\t\t\tinst.snapElements[ i ].item ) ) {\r\n\t\t\t\t\tif ( inst.snapElements[ i ].snapping ) {\r\n\t\t\t\t\t\t( inst.options.snap.release &&\r\n\t\t\t\t\t\t\tinst.options.snap.release.call(\r\n\t\t\t\t\t\t\t\tinst.element,\r\n\t\t\t\t\t\t\t\tevent,\r\n\t\t\t\t\t\t\t\tlangx.extend( inst._uiHash(), { snapItem: inst.snapElements[ i ].item } )\r\n\t\t\t\t\t\t\t) );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tinst.snapElements[ i ].snapping = false;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( o.snapMode !== \"inner\" ) {\r\n\t\t\t\t\tts = Math.abs( t - y2 ) <= d;\r\n\t\t\t\t\tbs = Math.abs( b - y1 ) <= d;\r\n\t\t\t\t\tls = Math.abs( l - x2 ) <= d;\r\n\t\t\t\t\trs = Math.abs( r - x1 ) <= d;\r\n\t\t\t\t\tif ( ts ) {\r\n\t\t\t\t\t\tui.position.top = inst._convertPositionTo( \"relative\", {\r\n\t\t\t\t\t\t\ttop: t - inst.helperProportions.height,\r\n\t\t\t\t\t\t\tleft: 0\r\n\t\t\t\t\t\t} ).top;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( bs ) {\r\n\t\t\t\t\t\tui.position.top = inst._convertPositionTo( \"relative\", {\r\n\t\t\t\t\t\t\ttop: b,\r\n\t\t\t\t\t\t\tleft: 0\r\n\t\t\t\t\t\t} ).top;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ls ) {\r\n\t\t\t\t\t\tui.position.left = inst._convertPositionTo( \"relative\", {\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t\tleft: l - inst.helperProportions.width\r\n\t\t\t\t\t\t} ).left;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( rs ) {\r\n\t\t\t\t\t\tui.position.left = inst._convertPositionTo( \"relative\", {\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t\tleft: r\r\n\t\t\t\t\t\t} ).left;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfirst = ( ts || bs || ls || rs );\r\n\r\n\t\t\t\tif ( o.snapMode !== \"outer\" ) {\r\n\t\t\t\t\tts = Math.abs( t - y1 ) <= d;\r\n\t\t\t\t\tbs = Math.abs( b - y2 ) <= d;\r\n\t\t\t\t\tls = Math.abs( l - x1 ) <= d;\r\n\t\t\t\t\trs = Math.abs( r - x2 ) <= d;\r\n\t\t\t\t\tif ( ts ) {\r\n\t\t\t\t\t\tui.position.top = inst._convertPositionTo( \"relative\", {\r\n\t\t\t\t\t\t\ttop: t,\r\n\t\t\t\t\t\t\tleft: 0\r\n\t\t\t\t\t\t} ).top;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( bs ) {\r\n\t\t\t\t\t\tui.position.top = inst._convertPositionTo( \"relative\", {\r\n\t\t\t\t\t\t\ttop: b - inst.helperProportions.height,\r\n\t\t\t\t\t\t\tleft: 0\r\n\t\t\t\t\t\t} ).top;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ls ) {\r\n\t\t\t\t\t\tui.position.left = inst._convertPositionTo( \"relative\", {\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t\tleft: l\r\n\t\t\t\t\t\t} ).left;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( rs ) {\r\n\t\t\t\t\t\tui.position.left = inst._convertPositionTo( \"relative\", {\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t\tleft: r - inst.helperProportions.width\r\n\t\t\t\t\t\t} ).left;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( !inst.snapElements[ i ].snapping && ( ts || bs || ls || rs || first ) ) {\r\n\t\t\t\t\t( inst.options.snap.snap &&\r\n\t\t\t\t\t\tinst.options.snap.snap.call(\r\n\t\t\t\t\t\t\tinst.element,\r\n\t\t\t\t\t\t\tevent,\r\n\t\t\t\t\t\t\tlangx.extend( inst._uiHash(), {\r\n\t\t\t\t\t\t\t\tsnapItem: inst.snapElements[ i ].item\r\n\t\t\t\t\t\t\t} ) ) );\r\n\t\t\t\t}\r\n\t\t\t\tinst.snapElements[ i ].snapping = ( ts || bs || ls || rs || first );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t} );\r\n\r\n\tpatch.add( Draggable, \"stack\", {\r\n\t\tstart: function( event, ui, instance ) {\r\n\t\t\tvar min,\r\n\t\t\t\to = instance.options,\r\n\t\t\t\tgroup = langx.makeArray( $( o.stack ) ).sort( function( a, b ) {\r\n\t\t\t\t\treturn ( parseInt( $( a ).css( \"zIndex\" ), 10 ) || 0 ) -\r\n\t\t\t\t\t\t( parseInt( $( b ).css( \"zIndex\" ), 10 ) || 0 );\r\n\t\t\t\t} );\r\n\r\n\t\t\tif ( !group.length ) { return; }\r\n\r\n\t\t\tmin = parseInt( $( group[ 0 ] ).css( \"zIndex\" ), 10 ) || 0;\r\n\t\t\t$( group ).each( function( i ) {\r\n\t\t\t\t$( this ).css( \"zIndex\", min + i );\r\n\t\t\t} );\r\n\t\t\tthis.css( \"zIndex\", ( min + group.length ) );\r\n\t\t}\r\n\t} );\r\n\r\n\tpatch.add( Draggable, \"zIndex\", {\r\n\t\tstart: function( event, ui, instance ) {\r\n\t\t\tvar t = $( ui.helper ),\r\n\t\t\t\to = instance.options;\r\n\r\n\t\t\tif ( t.css( \"zIndex\" ) ) {\r\n\t\t\t\to._zIndex = t.css( \"zIndex\" );\r\n\t\t\t}\r\n\t\t\tt.css( \"zIndex\", o.zIndex );\r\n\t\t},\r\n\t\tstop: function( event, ui, instance ) {\r\n\t\t\tvar o = instance.options;\r\n\r\n\t\t\tif ( o._zIndex ) {\r\n\t\t\t\t$( ui.helper ).css( \"zIndex\", o._zIndex );\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\treturn Draggable;\r\n});\r\n"]}