{"version":3,"sources":["JqueryPlugin.js"],"names":["define","types","objects","arrays","langx","datax","eventer","plugins","$","pluginUuid","JqPlugin","Plugin","inherit","klassName","pluginEventPrefix","options","create","destroy","this","overrided","element","off","eventNamespace","plugin","removeAttr","bindings","_construct","defaultElement","uuid","pluginName","classesElementLookup","hoverable","focusable","data","_on","remove","event","target","document","style","ownerDocument","window","defaultView","parentWindow","_create","_trigger","_getCreateEventData","_init","noop","_classes","bindRemoveEvent","each","_","isTracked","map","that","elements","some","is","processClassString","classes","checkOption","current","i","length","add","uniq","get","concat","not","full","push","mixin","keys","match","extra","join","_untrackClassesElement","key","value","inArray","_off","_removeClass","_toggleClass","_addClass","shift","toggleClass","suppressDisabledCheck","handlers","delegateElement","instance","widget","handler","handlerProxy","disabled","hasClass","apply","arguments","guid","eventName","selector","on","split","type","prop","orig","callback","proxy","widgetEventPrefix","toLowerCase","originalEvent","trigger","isFunction","isDefaultPrevented"],"mappings":"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","file":"../JqueryPlugin.js","sourcesContent":["define([\r\n\t\"skylark-langx/types\",\r\n\t\"skylark-langx/objects\",\r\n\t\"skylark-langx/arrays\",\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-utils-dom/datax\",\r\n\t\"skylark-utils-dom/eventer\",\r\n\t\"skylark-utils-dom/plugins\",\r\n\t\"skylark-utils-dom/query\",\r\n],function(types, objects, arrays, langx, datax, eventer, plugins, $){\r\n\r\n    var pluginUuid = 0;\r\n\r\n\tvar JqPlugin = plugins.Plugin.inherit({\r\n\t\tklassName : \"JqPlugin\",\r\n\r\n        pluginEventPrefix: \"\",\r\n\r\n        options: {\r\n            // Callbacks\r\n            create: null\r\n        },\r\n\r\n        destroy: function() {\r\n            this.overrided();\r\n\r\n            // We can probably remove the unbind calls in 2.0\r\n            // all event bindings should go through this._on()\r\n            this.element\r\n                .off( this.eventNamespace );\r\n\r\n            this.plugin()\r\n                .off( this.eventNamespace )\r\n                .removeAttr( \"aria-disabled\" );\r\n\r\n            // Clean up events and states\r\n            this.bindings.off( this.eventNamespace );\r\n        },\r\n\r\n        _construct : function(element,options) {\r\n            //this.options = langx.mixin( {}, this.options );\r\n\r\n            element = $( element || this.defaultElement || this )[ 0 ];\r\n\r\n            this.overrided(element,options);\r\n            \r\n            this.element = $( element );\r\n            this.uuid = pluginUuid++;\r\n            this.eventNamespace = \".\" + this.pluginName + this.uuid;\r\n\r\n            this.bindings = $();\r\n            this.classesElementLookup = {};\r\n\r\n\t\t\tthis.hoverable = $();\r\n\t\t\tthis.focusable = $();\r\n\r\n            if ( element !== this ) {\r\n                datax.data( element, this.pluginName, this );\r\n                this._on( true, this.element, {\r\n                    remove: function( event ) {\r\n                        if ( event.target === element ) {\r\n                            this.destroy();\r\n                        }\r\n                    }\r\n                } );\r\n                this.document = $( element.style ?\r\n\r\n                    // Element within the document\r\n                    element.ownerDocument :\r\n\r\n                    // Element is window or document\r\n                    element.document || element );\r\n                this.window = $( this.document[ 0 ].defaultView || this.document[ 0 ].parentWindow );\r\n            }\r\n\r\n//            this.options = langx.mixin( {},\r\n//                this.options,\r\n//                this._getCreateOptions(),\r\n//                options );\r\n\r\n            this._create();\r\n\r\n            this._trigger( \"create\", null, this._getCreateEventData() );\r\n\r\n            this._init();\r\n        },\r\n\r\n//        _getCreateOptions: function() {\r\n//            return {};\r\n//        },\r\n\r\n        _getCreateEventData: langx.noop,\r\n\r\n        _create: langx.noop,\r\n\r\n        _init: langx.noop,\r\n\r\n\t\t_classes: function( options ) {\r\n\t\t\tvar full = [];\r\n\t\t\tvar that = this;\r\n\r\n\t\t\toptions = objects.mixin( {\r\n\t\t\t\telement: this.element,\r\n\t\t\t\tclasses: this.options.classes || {}\r\n\t\t\t}, options );\r\n\r\n\r\n\t\t\tfunction bindRemoveEvent() {\r\n\t\t\t\toptions.element.each( function( _, element ) {\r\n\t\t\t\t\tvar isTracked = langx.map( that.classesElementLookup, function( elements ) {\r\n\t\t\t\t\t\treturn elements;\r\n\t\t\t\t\t} )\r\n\t\t\t\t\t\t.some( function(elements ) {\r\n\t\t\t\t\t\t\treturn $(elements).is( element );\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tif ( !isTracked ) {\r\n\t\t\t\t\t\tthat._on( $( element ), {\r\n\t\t\t\t\t\t\tremove: \"_untrackClassesElement\"\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\tfunction processClassString( classes, checkOption ) {\r\n\t\t\t\tvar current, i;\r\n\t\t\t\tfor ( i = 0; i < classes.length; i++ ) {\r\n\t\t\t\t\tcurrent = that.classesElementLookup[ classes[ i ] ] || $();\r\n\t\t\t\t\tif ( options.add ) {\r\n\t\t\t\t\t\tbindRemoveEvent();\r\n\t\t\t\t\t\tcurrent = $( langx.uniq( current.get().concat( options.element.get() ) ) );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcurrent = $( current.not( options.element ).get() );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.classesElementLookup[ classes[ i ] ] = current;\r\n\t\t\t\t\tfull.push( classes[ i ] );\r\n\t\t\t\t\tif ( checkOption && options.classes[ classes[ i ] ] ) {\r\n\t\t\t\t\t\tfull.push( options.classes[ classes[ i ] ] );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ( options.keys ) {\r\n\t\t\t\tprocessClassString( options.keys.match( /\\S+/g ) || [], true );\r\n\t\t\t}\r\n\t\t\tif ( options.extra ) {\r\n\t\t\t\tprocessClassString( options.extra.match( /\\S+/g ) || [] );\r\n\t\t\t}\r\n\r\n\t\t\treturn full.join( \" \" );\r\n\t\t},\r\n\r\n\t\t_untrackClassesElement: function( event ) {\r\n\t\t\tvar that = this;\r\n\t\t\tlangx.each( that.classesElementLookup, function( key, value ) {\r\n\t\t\t\tif ( arrays.inArray( event.target, value ) !== -1 ) {\r\n\t\t\t\t\tthat.classesElementLookup[ key ] = $( value.not( event.target ).get() );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\tthis._off( $( event.target ) );\r\n\t\t},\r\n\r\n\t\t_removeClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, false );\r\n\t\t},\r\n\r\n\t\t_addClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, true );\r\n\t\t},\r\n\r\n\t\t_toggleClass: function( element, keys, extra, add ) {\r\n\t\t\tadd = ( typeof add === \"boolean\" ) ? add : extra;\r\n\t\t\tvar shift = ( typeof element === \"string\" || element === null ),\r\n\t\t\t\toptions = {\r\n\t\t\t\t\textra: shift ? keys : extra,\r\n\t\t\t\t\tkeys: shift ? element : keys,\r\n\t\t\t\t\telement: shift ? this.element : element,\r\n\t\t\t\t\tadd: add\r\n\t\t\t\t};\r\n\t\t\toptions.element.toggleClass( this._classes( options ), add );\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t_on: function( suppressDisabledCheck, element, handlers ) {\r\n\t\t\tvar delegateElement;\r\n\t\t\tvar instance = this;\r\n\r\n\t\t\t// No suppressDisabledCheck flag, shuffle arguments\r\n\t\t\tif ( typeof suppressDisabledCheck !== \"boolean\" ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = suppressDisabledCheck;\r\n\t\t\t\tsuppressDisabledCheck = false;\r\n\t\t\t}\r\n\r\n\t\t\t// No element argument, shuffle and use this.element\r\n\t\t\tif ( !handlers ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = this.element;\r\n\t\t\t\tdelegateElement = this.widget();\r\n\t\t\t} else {\r\n\t\t\t\telement = delegateElement = $( element );\r\n\t\t\t\tthis.bindings = this.bindings.add( element );\r\n\t\t\t}\r\n\r\n\t\t\tobjects.each( handlers, function( event, handler ) {\r\n\t\t\t\tfunction handlerProxy() {\r\n\r\n\t\t\t\t\t// Allow widgets to customize the disabled handling\r\n\t\t\t\t\t// - disabled as an array instead of boolean\r\n\t\t\t\t\t// - disabled class as method for disabling individual parts\r\n\t\t\t\t\tif ( !suppressDisabledCheck &&\r\n\t\t\t\t\t\t\t( instance.options.disabled === true ||\r\n\t\t\t\t\t\t\t$( this ).hasClass( \"ui-state-disabled\" ) ) ) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ( typeof handler === \"string\" ? instance[ handler ] : handler )\r\n\t\t\t\t\t\t.apply( instance, arguments );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Copy the guid so direct unbinding works\r\n\t\t\t\tif ( typeof handler !== \"string\" ) {\r\n\t\t\t\t\thandlerProxy.guid = handler.guid =\r\n\t\t\t\t\t\thandler.guid || handlerProxy.guid || $.guid++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar match = event.match( /^([\\w:-]*)\\s*(.*)$/ );\r\n\t\t\t\tvar eventName = match[ 1 ] + instance.eventNamespace;\r\n\t\t\t\tvar selector = match[ 2 ];\r\n\r\n\t\t\t\tif ( selector ) {\r\n\t\t\t\t\tdelegateElement.on( eventName, selector, handlerProxy );\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.on( eventName, handlerProxy );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\r\n\t\t_off: function( element, eventName ) {\r\n\t\t\teventName = ( eventName || \"\" ).split( \" \" ).join( this.eventNamespace + \" \" ) +\r\n\t\t\t\tthis.eventNamespace;\r\n\t\t\telement.off( eventName );\r\n\r\n\t\t\t// Clear the stack to avoid memory leaks (#10056)\r\n\t\t\tthis.bindings = $( this.bindings.not( element ).get() );\r\n\t\t\tthis.focusable = $( this.focusable.not( element ).get() );\r\n\t\t\tthis.hoverable = $( this.hoverable.not( element ).get() );\r\n\t\t},\r\n\r\n\t\t_trigger: function( type, event, data ) {\r\n\t\t\tvar prop, orig;\r\n\t\t\tvar callback = this.options[ type ];\r\n\r\n\t\t\tdata = data || {};\r\n\t\t\tevent = eventer.proxy( event );\r\n\t\t\tevent.type = ( type === this.widgetEventPrefix ?\r\n\t\t\t\ttype :\r\n\t\t\t\tthis.widgetEventPrefix + type ).toLowerCase();\r\n\r\n\t\t\t// The original event may come from any element\r\n\t\t\t// so we need to reset the target on the new event\r\n\t\t\tevent.target = this.element[ 0 ];\r\n\r\n\t\t\t// Copy original event properties over to the new event\r\n\t\t\torig = event.originalEvent;\r\n\t\t\tif ( orig ) {\r\n\t\t\t\tfor ( prop in orig ) {\r\n\t\t\t\t\tif ( !( prop in event ) ) {\r\n\t\t\t\t\t\tevent[ prop ] = orig[ prop ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.element.trigger( event, data );\r\n\t\t\treturn !( types.isFunction( callback ) &&\r\n\t\t\t\tcallback.apply( this.element[ 0 ], [ event ].concat( data ) ) === false ||\r\n\t\t\t\tevent.isDefaultPrevented() );\r\n\t\t}\r\n\r\n\t});\r\n\r\n\treturn JqPlugin;\r\n});"]}