{"version":3,"sources":["JqueryPlugin.js"],"names":["define","types","objects","arrays","langx","datax","eventer","plugins","$","pluginUuid","JqPlugin","Plugin","inherit","klassName","pluginEventPrefix","options","create","destroy","this","overrided","element","off","eventNamespace","bindings","_construct","defaultElement","uuid","pluginName","classesElementLookup","hoverable","focusable","data","_on","remove","event","target","document","style","ownerDocument","window","defaultView","parentWindow","_create","_trigger","_getCreateEventData","_init","noop","_classes","bindRemoveEvent","each","_","isTracked","map","that","elements","some","is","processClassString","classes","checkOption","current","i","length","add","uniq","get","concat","not","full","push","mixin","keys","match","extra","join","_untrackClassesElement","key","value","inArray","_off","_removeClass","_toggleClass","_addClass","shift","toggleClass","suppressDisabledCheck","handlers","delegateElement","instance","widget","handler","handlerProxy","disabled","hasClass","apply","arguments","guid","eventName","selector","on","split","type","prop","orig","callback","proxy","widgetEventPrefix","toLowerCase","originalEvent","trigger","isFunction","isDefaultPrevented"],"mappings":"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","file":"../JqueryPlugin.js","sourcesContent":["define([\r\n\t\"skylark-langx/types\",\r\n\t\"skylark-langx/objects\",\r\n\t\"skylark-langx/arrays\",\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-utils-dom/datax\",\r\n\t\"skylark-utils-dom/eventer\",\r\n\t\"skylark-utils-dom/plugins\",\r\n\t\"skylark-utils-dom/query\",\r\n],function(types, objects, arrays, langx, datax, eventer, plugins, $){\r\n\r\n    var pluginUuid = 0;\r\n\r\n\tvar JqPlugin = plugins.Plugin.inherit({\r\n\t\tklassName : \"JqPlugin\",\r\n\r\n        pluginEventPrefix: \"\",\r\n\r\n        options: {\r\n            // Callbacks\r\n            create: null\r\n        },\r\n\r\n        destroy: function() {\r\n            this.overrided();\r\n\r\n            // We can probably remove the unbind calls in 2.0\r\n            // all event bindings should go through this._on()\r\n            this.element\r\n                .off( this.eventNamespace );\r\n\r\n            // Clean up events and states\r\n            this.bindings.off( this.eventNamespace );\r\n        },\r\n\r\n        _construct : function(element,options) {\r\n            //this.options = langx.mixin( {}, this.options );\r\n\r\n            element = $( element || this.defaultElement || this )[ 0 ];\r\n\r\n            this.overrided(element,options);\r\n            \r\n            this.element = $( element );\r\n            this.uuid = pluginUuid++;\r\n            this.eventNamespace = \".\" + this.pluginName + this.uuid;\r\n\r\n            this.bindings = $();\r\n            this.classesElementLookup = {};\r\n\r\n\t\t\tthis.hoverable = $();\r\n\t\t\tthis.focusable = $();\r\n\r\n            if ( element !== this ) {\r\n                datax.data( element, this.pluginName, this );\r\n                this._on( true, this.element, {\r\n                    remove: function( event ) {\r\n                        if ( event.target === element ) {\r\n                            this.destroy();\r\n                        }\r\n                    }\r\n                } );\r\n                this.document = $( element.style ?\r\n\r\n                    // Element within the document\r\n                    element.ownerDocument :\r\n\r\n                    // Element is window or document\r\n                    element.document || element );\r\n                this.window = $( this.document[ 0 ].defaultView || this.document[ 0 ].parentWindow );\r\n            }\r\n\r\n//            this.options = langx.mixin( {},\r\n//                this.options,\r\n//                this._getCreateOptions(),\r\n//                options );\r\n\r\n            this._create();\r\n\r\n            this._trigger( \"create\", null, this._getCreateEventData() );\r\n\r\n            this._init();\r\n        },\r\n\r\n//        _getCreateOptions: function() {\r\n//            return {};\r\n//        },\r\n\r\n        _getCreateEventData: langx.noop,\r\n\r\n        _create: langx.noop,\r\n\r\n        _init: langx.noop,\r\n\r\n\t\t_classes: function( options ) {\r\n\t\t\tvar full = [];\r\n\t\t\tvar that = this;\r\n\r\n\t\t\toptions = objects.mixin( {\r\n\t\t\t\telement: this.element,\r\n\t\t\t\tclasses: this.options.classes || {}\r\n\t\t\t}, options );\r\n\r\n\r\n\t\t\tfunction bindRemoveEvent() {\r\n\t\t\t\toptions.element.each( function( _, element ) {\r\n\t\t\t\t\tvar isTracked = langx.map( that.classesElementLookup, function( elements ) {\r\n\t\t\t\t\t\treturn elements;\r\n\t\t\t\t\t} )\r\n\t\t\t\t\t\t.some( function(elements ) {\r\n\t\t\t\t\t\t\treturn $(elements).is( element );\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tif ( !isTracked ) {\r\n\t\t\t\t\t\tthat._on( $( element ), {\r\n\t\t\t\t\t\t\tremove: \"_untrackClassesElement\"\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\tfunction processClassString( classes, checkOption ) {\r\n\t\t\t\tvar current, i;\r\n\t\t\t\tfor ( i = 0; i < classes.length; i++ ) {\r\n\t\t\t\t\tcurrent = that.classesElementLookup[ classes[ i ] ] || $();\r\n\t\t\t\t\tif ( options.add ) {\r\n\t\t\t\t\t\tbindRemoveEvent();\r\n\t\t\t\t\t\tcurrent = $( langx.uniq( current.get().concat( options.element.get() ) ) );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcurrent = $( current.not( options.element ).get() );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.classesElementLookup[ classes[ i ] ] = current;\r\n\t\t\t\t\tfull.push( classes[ i ] );\r\n\t\t\t\t\tif ( checkOption && options.classes[ classes[ i ] ] ) {\r\n\t\t\t\t\t\tfull.push( options.classes[ classes[ i ] ] );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ( options.keys ) {\r\n\t\t\t\tprocessClassString( options.keys.match( /\\S+/g ) || [], true );\r\n\t\t\t}\r\n\t\t\tif ( options.extra ) {\r\n\t\t\t\tprocessClassString( options.extra.match( /\\S+/g ) || [] );\r\n\t\t\t}\r\n\r\n\t\t\treturn full.join( \" \" );\r\n\t\t},\r\n\r\n\t\t_untrackClassesElement: function( event ) {\r\n\t\t\tvar that = this;\r\n\t\t\tlangx.each( that.classesElementLookup, function( key, value ) {\r\n\t\t\t\tif ( arrays.inArray( event.target, value ) !== -1 ) {\r\n\t\t\t\t\tthat.classesElementLookup[ key ] = $( value.not( event.target ).get() );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\tthis._off( $( event.target ) );\r\n\t\t},\r\n\r\n\t\t_removeClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, false );\r\n\t\t},\r\n\r\n\t\t_addClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, true );\r\n\t\t},\r\n\r\n\t\t_toggleClass: function( element, keys, extra, add ) {\r\n\t\t\tadd = ( typeof add === \"boolean\" ) ? add : extra;\r\n\t\t\tvar shift = ( typeof element === \"string\" || element === null ),\r\n\t\t\t\toptions = {\r\n\t\t\t\t\textra: shift ? keys : extra,\r\n\t\t\t\t\tkeys: shift ? element : keys,\r\n\t\t\t\t\telement: shift ? this.element : element,\r\n\t\t\t\t\tadd: add\r\n\t\t\t\t};\r\n\t\t\toptions.element.toggleClass( this._classes( options ), add );\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t_on: function( suppressDisabledCheck, element, handlers ) {\r\n\t\t\tvar delegateElement;\r\n\t\t\tvar instance = this;\r\n\r\n\t\t\t// No suppressDisabledCheck flag, shuffle arguments\r\n\t\t\tif ( typeof suppressDisabledCheck !== \"boolean\" ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = suppressDisabledCheck;\r\n\t\t\t\tsuppressDisabledCheck = false;\r\n\t\t\t}\r\n\r\n\t\t\t// No element argument, shuffle and use this.element\r\n\t\t\tif ( !handlers ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = this.element;\r\n\t\t\t\tdelegateElement = this.widget();\r\n\t\t\t} else {\r\n\t\t\t\telement = delegateElement = $( element );\r\n\t\t\t\tthis.bindings = this.bindings.add( element );\r\n\t\t\t}\r\n\r\n\t\t\tobjects.each( handlers, function( event, handler ) {\r\n\t\t\t\tfunction handlerProxy() {\r\n\r\n\t\t\t\t\t// Allow widgets to customize the disabled handling\r\n\t\t\t\t\t// - disabled as an array instead of boolean\r\n\t\t\t\t\t// - disabled class as method for disabling individual parts\r\n\t\t\t\t\tif ( !suppressDisabledCheck &&\r\n\t\t\t\t\t\t\t( instance.options.disabled === true ||\r\n\t\t\t\t\t\t\t$( this ).hasClass( \"ui-state-disabled\" ) ) ) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ( typeof handler === \"string\" ? instance[ handler ] : handler )\r\n\t\t\t\t\t\t.apply( instance, arguments );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Copy the guid so direct unbinding works\r\n\t\t\t\tif ( typeof handler !== \"string\" ) {\r\n\t\t\t\t\thandlerProxy.guid = handler.guid =\r\n\t\t\t\t\t\thandler.guid || handlerProxy.guid || $.guid++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar match = event.match( /^([\\w:-]*)\\s*(.*)$/ );\r\n\t\t\t\tvar eventName = match[ 1 ] + instance.eventNamespace;\r\n\t\t\t\tvar selector = match[ 2 ];\r\n\r\n\t\t\t\tif ( selector ) {\r\n\t\t\t\t\tdelegateElement.on( eventName, selector, handlerProxy );\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.on( eventName, handlerProxy );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\r\n\t\t_off: function( element, eventName ) {\r\n\t\t\teventName = ( eventName || \"\" ).split( \" \" ).join( this.eventNamespace + \" \" ) +\r\n\t\t\t\tthis.eventNamespace;\r\n\t\t\telement.off( eventName );\r\n\r\n\t\t\t// Clear the stack to avoid memory leaks (#10056)\r\n\t\t\tthis.bindings = $( this.bindings.not( element ).get() );\r\n\t\t\tthis.focusable = $( this.focusable.not( element ).get() );\r\n\t\t\tthis.hoverable = $( this.hoverable.not( element ).get() );\r\n\t\t},\r\n\r\n\t\t_trigger: function( type, event, data ) {\r\n\t\t\tvar prop, orig;\r\n\t\t\tvar callback = this.options[ type ];\r\n\r\n\t\t\tdata = data || {};\r\n\t\t\tevent = eventer.proxy( event );\r\n\t\t\tevent.type = ( type === this.widgetEventPrefix ?\r\n\t\t\t\ttype :\r\n\t\t\t\tthis.widgetEventPrefix + type ).toLowerCase();\r\n\r\n\t\t\t// The original event may come from any element\r\n\t\t\t// so we need to reset the target on the new event\r\n\t\t\tevent.target = this.element[ 0 ];\r\n\r\n\t\t\t// Copy original event properties over to the new event\r\n\t\t\torig = event.originalEvent;\r\n\t\t\tif ( orig ) {\r\n\t\t\t\tfor ( prop in orig ) {\r\n\t\t\t\t\tif ( !( prop in event ) ) {\r\n\t\t\t\t\t\tevent[ prop ] = orig[ prop ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.element.trigger( event, data );\r\n\t\t\treturn !( types.isFunction( callback ) &&\r\n\t\t\t\tcallback.apply( this.element[ 0 ], [ event ].concat( data ) ) === false ||\r\n\t\t\t\tevent.isDefaultPrevented() );\r\n\t\t}\r\n\r\n\t});\r\n\r\n\treturn JqPlugin;\r\n});"]}