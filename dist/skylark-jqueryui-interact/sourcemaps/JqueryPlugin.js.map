{"version":3,"sources":["JqueryPlugin.js"],"names":["define","types","objects","arrays","langx","eventer","plugins","$","JqPlugin","Plugin","inherit","klassName","_classes","options","bindRemoveEvent","element","each","_","isTracked","map","that","classesElementLookup","elements","some","is","_on","remove","processClassString","classes","checkOption","current","i","length","add","uniq","get","concat","not","full","push","this","mixin","keys","match","extra","join","_untrackClassesElement","event","key","value","inArray","target","_off","_removeClass","_toggleClass","_addClass","shift","toggleClass","suppressDisabledCheck","handlers","delegateElement","instance","bindings","widget","handler","handlerProxy","disabled","hasClass","apply","arguments","guid","eventName","eventNamespace","selector","on","split","off","focusable","hoverable","_trigger","type","data","prop","orig","callback","proxy","widgetEventPrefix","toLowerCase","originalEvent","trigger","isFunction","isDefaultPrevented"],"mappings":"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","file":"../JqueryPlugin.js","sourcesContent":["define([\r\n\t\"skylark-langx/types\",\r\n\t\"skylark-langx/objects\",\r\n\t\"skylark-langx/arrays\",\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-utils-dom/eventer\",\r\n\t\"skylark-utils-dom/plugins\",\r\n\t\"skylark-utils-dom/query\",\r\n],function(types, objects, arrays, langx, eventer, plugins, $){\r\n\r\n\tvar JqPlugin = plugins.Plugin.inherit({\r\n\t\tklassName : \"JqPlugin\",\r\n\r\n\t\t_classes: function( options ) {\r\n\t\t\tvar full = [];\r\n\t\t\tvar that = this;\r\n\r\n\t\t\toptions = objects.mixin( {\r\n\t\t\t\telement: this.element,\r\n\t\t\t\tclasses: this.options.classes || {}\r\n\t\t\t}, options );\r\n\r\n\t\t\tfunction bindRemoveEvent() {\r\n\t\t\t\toptions.element.each( function( _, element ) {\r\n\t\t\t\t\tvar isTracked = langx.map( that.classesElementLookup, function( elements ) {\r\n\t\t\t\t\t\treturn elements;\r\n\t\t\t\t\t} )\r\n\t\t\t\t\t\t.some( function(elements ) {\r\n\t\t\t\t\t\t\treturn $(elements).is( element );\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tif ( !isTracked ) {\r\n\t\t\t\t\t\tthat._on( $( element ), {\r\n\t\t\t\t\t\t\tremove: \"_untrackClassesElement\"\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\tfunction processClassString( classes, checkOption ) {\r\n\t\t\t\tvar current, i;\r\n\t\t\t\tfor ( i = 0; i < classes.length; i++ ) {\r\n\t\t\t\t\tcurrent = that.classesElementLookup[ classes[ i ] ] || $();\r\n\t\t\t\t\tif ( options.add ) {\r\n\t\t\t\t\t\tbindRemoveEvent();\r\n\t\t\t\t\t\tcurrent = $( langx.uniq( current.get().concat( options.element.get() ) ) );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcurrent = $( current.not( options.element ).get() );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.classesElementLookup[ classes[ i ] ] = current;\r\n\t\t\t\t\tfull.push( classes[ i ] );\r\n\t\t\t\t\tif ( checkOption && options.classes[ classes[ i ] ] ) {\r\n\t\t\t\t\t\tfull.push( options.classes[ classes[ i ] ] );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ( options.keys ) {\r\n\t\t\t\tprocessClassString( options.keys.match( /\\S+/g ) || [], true );\r\n\t\t\t}\r\n\t\t\tif ( options.extra ) {\r\n\t\t\t\tprocessClassString( options.extra.match( /\\S+/g ) || [] );\r\n\t\t\t}\r\n\r\n\t\t\treturn full.join( \" \" );\r\n\t\t},\r\n\r\n\t\t_untrackClassesElement: function( event ) {\r\n\t\t\tvar that = this;\r\n\t\t\tlangx.each( that.classesElementLookup, function( key, value ) {\r\n\t\t\t\tif ( arrays.inArray( event.target, value ) !== -1 ) {\r\n\t\t\t\t\tthat.classesElementLookup[ key ] = $( value.not( event.target ).get() );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\tthis._off( $( event.target ) );\r\n\t\t},\r\n\r\n\t\t_removeClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, false );\r\n\t\t},\r\n\r\n\t\t_addClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, true );\r\n\t\t},\r\n\r\n\t\t_toggleClass: function( element, keys, extra, add ) {\r\n\t\t\tadd = ( typeof add === \"boolean\" ) ? add : extra;\r\n\t\t\tvar shift = ( typeof element === \"string\" || element === null ),\r\n\t\t\t\toptions = {\r\n\t\t\t\t\textra: shift ? keys : extra,\r\n\t\t\t\t\tkeys: shift ? element : keys,\r\n\t\t\t\t\telement: shift ? this.element : element,\r\n\t\t\t\t\tadd: add\r\n\t\t\t\t};\r\n\t\t\toptions.element.toggleClass( this._classes( options ), add );\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t_on: function( suppressDisabledCheck, element, handlers ) {\r\n\t\t\tvar delegateElement;\r\n\t\t\tvar instance = this;\r\n\r\n\t\t\t// No suppressDisabledCheck flag, shuffle arguments\r\n\t\t\tif ( typeof suppressDisabledCheck !== \"boolean\" ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = suppressDisabledCheck;\r\n\t\t\t\tsuppressDisabledCheck = false;\r\n\t\t\t}\r\n\r\n\t\t\t// No element argument, shuffle and use this.element\r\n\t\t\tif ( !handlers ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = this.element;\r\n\t\t\t\tdelegateElement = this.widget();\r\n\t\t\t} else {\r\n\t\t\t\telement = delegateElement = $( element );\r\n\t\t\t\tthis.bindings = this.bindings.add( element );\r\n\t\t\t}\r\n\r\n\t\t\tobjects.each( handlers, function( event, handler ) {\r\n\t\t\t\tfunction handlerProxy() {\r\n\r\n\t\t\t\t\t// Allow widgets to customize the disabled handling\r\n\t\t\t\t\t// - disabled as an array instead of boolean\r\n\t\t\t\t\t// - disabled class as method for disabling individual parts\r\n\t\t\t\t\tif ( !suppressDisabledCheck &&\r\n\t\t\t\t\t\t\t( instance.options.disabled === true ||\r\n\t\t\t\t\t\t\t$( this ).hasClass( \"ui-state-disabled\" ) ) ) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ( typeof handler === \"string\" ? instance[ handler ] : handler )\r\n\t\t\t\t\t\t.apply( instance, arguments );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Copy the guid so direct unbinding works\r\n\t\t\t\tif ( typeof handler !== \"string\" ) {\r\n\t\t\t\t\thandlerProxy.guid = handler.guid =\r\n\t\t\t\t\t\thandler.guid || handlerProxy.guid || $.guid++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar match = event.match( /^([\\w:-]*)\\s*(.*)$/ );\r\n\t\t\t\tvar eventName = match[ 1 ] + instance.eventNamespace;\r\n\t\t\t\tvar selector = match[ 2 ];\r\n\r\n\t\t\t\tif ( selector ) {\r\n\t\t\t\t\tdelegateElement.on( eventName, selector, handlerProxy );\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.on( eventName, handlerProxy );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\r\n\t\t_off: function( element, eventName ) {\r\n\t\t\teventName = ( eventName || \"\" ).split( \" \" ).join( this.eventNamespace + \" \" ) +\r\n\t\t\t\tthis.eventNamespace;\r\n\t\t\telement.off( eventName );\r\n\r\n\t\t\t// Clear the stack to avoid memory leaks (#10056)\r\n\t\t\tthis.bindings = $( this.bindings.not( element ).get() );\r\n\t\t\tthis.focusable = $( this.focusable.not( element ).get() );\r\n\t\t\tthis.hoverable = $( this.hoverable.not( element ).get() );\r\n\t\t},\r\n\r\n\t\t_trigger: function( type, event, data ) {\r\n\t\t\tvar prop, orig;\r\n\t\t\tvar callback = this.options[ type ];\r\n\r\n\t\t\tdata = data || {};\r\n\t\t\tevent = eventer.proxy( event );\r\n\t\t\tevent.type = ( type === this.widgetEventPrefix ?\r\n\t\t\t\ttype :\r\n\t\t\t\tthis.widgetEventPrefix + type ).toLowerCase();\r\n\r\n\t\t\t// The original event may come from any element\r\n\t\t\t// so we need to reset the target on the new event\r\n\t\t\tevent.target = this.element[ 0 ];\r\n\r\n\t\t\t// Copy original event properties over to the new event\r\n\t\t\torig = event.originalEvent;\r\n\t\t\tif ( orig ) {\r\n\t\t\t\tfor ( prop in orig ) {\r\n\t\t\t\t\tif ( !( prop in event ) ) {\r\n\t\t\t\t\t\tevent[ prop ] = orig[ prop ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.element.trigger( event, data );\r\n\t\t\treturn !( types.isFunction( callback ) &&\r\n\t\t\t\tcallback.apply( this.element[ 0 ], [ event ].concat( data ) ) === false ||\r\n\t\t\t\tevent.isDefaultPrevented() );\r\n\t\t}\r\n\r\n\t});\r\n\r\n\treturn JqPlugin;\r\n});"]}